# 백테스트 분석 기록

프로젝트의 백테스트 최적화 및 가설 검증 작업 기록

---

## 2026-01-07: 빠른 반등 종목 추가 보유 전략 검증

### 가설
"RSI < 35로 매수한 종목 중, 3일 이내에 RSI 70을 넘은 종목은 더 강한 상승 모멘텀을 가지므로 3일 더 보유하면 더 큰 수익을 얻을 수 있지 않을까?"

### 비교 전략
- **전략 A (기존)**: RSI > 70 도달 시 즉시 매도
- **전략 B (새로운)**: 3일 내 RSI 70 도달 시 3일 추가 보유 후 매도

### 결과 (2005-2025, 20년간)

| 전략 | 수익률 | 승률 | 거래횟수 | 평균보유일 | 빠른 반등 비율 |
|------|--------|------|----------|------------|----------------|
| A (기존) | 24,696.68% | 67.39% | 1,334회 | 26.4일 | - |
| B (추가보유) | 21,938.39% | 67.35% | 1,326회 | 26.6일 | 2.8% |
| **차이** | **-2,758.29%p** | -0.05%p | -8회 | +0.2일 | - |

### 주요 발견

1. **빠른 반등 종목은 매우 드물다**
   - 전체 거래 중 단 2.8% (37/1,326건)만 3일 내 RSI 70 도달
   - 대부분 종목은 RSI 70 도달에 4일 이상 소요

2. **가설 기각**
   - 추가 보유 전략은 오히려 수익률 2,758%p 감소
   - RSI 70 도달 시점이 최적 매도 타이밍
   - 빠른 반등 후 추가 상승 모멘텀은 제한적

3. **결론: 기존 전략 유지**
   - RSI 70 도달 시 즉시 매도하는 것이 최적
   - "빠른 반등 = 강한 모멘텀" 가설은 데이터로 지지되지 않음

### 파일
- 스크립트: `compare_hold_extension_strategy.py`
- 보고서: `reports/hold_extension_strategy.md`
- 데이터: `reports/hold_extension_comparison.csv`

---

## 2026-01-07: 손실 쿨다운 최적화 (연도별 분석)

### 배경
기존 최적화는 전체 기간 누적 수익률로 평가했으나, 복리 효과로 인해 후반부 연도의 영향이 과도하게 반영되는 문제 발견.

### 분석 방법
1. **연도별 균등 가중 평가**: 각 연도의 수익률을 동일한 가중치로 평균
2. **2025년 단독 분석**: 최신 시장 환경에서의 성과
3. **연도별 개별 최적화**: 2005-2025년 각 연도별 최적 쿨다운 도출

### 결과

#### 방법 1: 연도별 균등 가중 (2005-2025)
- **최적 쿨다운**: 60일
- **평균 연간 수익률**: 35.15%
- 테스트 범위: 0, 10, 20, 30, 40, 60, 90, 120, 180일

#### 방법 2: 2025년 단독 분석
- **최적 쿨다운**: 60일
- **수익률**: 117.23%
- **승률**: 76.39%
- **반복 손실**: 0개

#### 방법 3: 연도별 개별 최적화
- **가장 많이 선정**: 0일 (8년, 36.4%)
- **전기간 평균 최고**: 60일 (평균 33.19%)
- **최근 추세 (2018-2025)**: 평균 51.1일

### 결론
- **5가지 다른 평가 방법 모두 60일 쿨다운이 최적**
- 연도별 변동성은 있으나, 장기적으로 60일이 가장 안정적
- 현재 전략 파라미터(60일) 유지 권장

### 파일
- `optimize_loss_cooldown_by_yearly_avg.py` - 연도별 균등 가중
- `optimize_loss_cooldown_2025.py` - 2025년 단독
- `optimize_loss_cooldown_by_year.py` - 연도별 개별
- `reports/loss_cooldown_optimization_yearly_avg.md`
- `reports/loss_cooldown_optimization_2025.md`
- `reports/loss_cooldown_optimization_by_year.md`

---

## 이전 최적화 기록

### 전략 B 보유 기간 최적화
- **결과**: 60일이 최적
- **보고서**: `reports/holding_days_optimization.md`

### 전략 B 손실 쿨다운 최적화 (초기)
- **결과**: 60일이 최적
- **보고서**: `reports/loss_cooldown_optimization.md`

### 전략 B 손실/수익 분석
- 상위 손실 종목 분석: `reports/strategy_b_loss_analysis.md`
- 상위 수익 종목 분석: `reports/strategy_b_profit_analysis.md`
- 손실률 기준 분석: `reports/strategy_b_loss_by_pct_analysis.md`
- 수익률 기준 분석: `reports/strategy_b_profit_by_pct_analysis.md`

---

## 현재 최적 파라미터 (전략 B)

```python
RSI_WINDOW = 5
BUY_THRESHOLD = 35
SELL_THRESHOLD = 70
SMA_WINDOW = 50
MAX_HOLDING_DAYS = 60      # 최적화 완료
LOSS_COOLDOWN_DAYS = 60    # 최적화 완료
```

### 매수 조건
- RSI(5) < 35
- Close > SMA(50)
- 손실 쿨다운 종목 제외

### 매도 조건
- RSI(5) > 70 **즉시 매도** (추가 보유 X)
- 또는 60일 경과 시 강제 매도

### 검증된 가설
- ❌ "빠른 반등 종목 추가 보유" - 오히려 수익률 감소
- ✅ "60일 손실 쿨다운" - 여러 방법으로 검증됨
- ✅ "60일 최대 보유 기간" - 최적 파라미터 확인
